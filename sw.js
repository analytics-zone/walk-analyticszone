const CACHE_VERSION='efd706bf16bf';const CACHE_NAME=`analyticszone-${CACHE_VERSION}`;const PRECACHE_ASSETS=['/assets/css/main.min.css','/assets/js/core.min.js','/assets/js/search.min.js'];self.addEventListener('install',(event)=>{event.waitUntil(caches.open(CACHE_NAME).then((cache)=>cache.addAll(PRECACHE_ASSETS)).then(()=>self.skipWaiting()));});self.addEventListener('activate',(event)=>{event.waitUntil(caches.keys().then((keys)=>{return Promise.all(keys.filter((key)=>key!==CACHE_NAME).map((key)=>caches.delete(key)));}).then(()=>self.clients.claim()));});self.addEventListener('fetch',(event)=>{const{request}=event;const url=new URL(request.url);if(request.method!=='GET')return;if(url.origin!==location.origin)return;if(url.pathname.includes('analytics')||url.hostname.includes('google'))return;if(isStaticAsset(url.pathname)){event.respondWith(cacheFirst(request));}else if(url.pathname.endsWith('.html')||url.pathname.endsWith('/')){event.respondWith(networkFirst(request));}});function isStaticAsset(pathname){return/\.(css|js|png|jpg|jpeg|gif|svg|webp|woff2?|ico)$/i.test(pathname)||pathname.startsWith('/assets/');}
async function cacheFirst(request){const cached=await caches.match(request);if(cached)return cached;try{const response=await fetch(request);if(response.ok){const cache=await caches.open(CACHE_NAME);cache.put(request,response.clone());}
return response;}catch(error){return new Response('Offline',{status:503});}}
async function networkFirst(request){try{const response=await fetch(request);if(response.ok){const cache=await caches.open(CACHE_NAME);cache.put(request,response.clone());}
return response;}catch(error){const cached=await caches.match(request);return cached||new Response('Offline',{status:503});}}